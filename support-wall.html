<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Support Wall • The Footballer’s Sister</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --accent:#be185d;
      --muted:#6b7280;
      --divider:rgba(243,211,226,0.75);
    }

    body{
      background:#fff6f8;
      margin:0;
      padding-bottom:120px;
      font-family: ui-sans-serif, system-ui;
      -webkit-font-smoothing:antialiased;
    }

    header{
      background:linear-gradient(180deg,rgba(246,213,239,0.6),rgba(255,241,248,0.6));
      border-bottom:1px solid rgba(235,200,215,0.6);
      backdrop-filter:blur(4px);
      position:sticky;
      top:0;
      z-index:50;
    }

    .site-title{
      color:var(--accent);
      font-weight:800;
      letter-spacing:.02em;
    }

    .footer-badge{
      display:inline-block;
      background:linear-gradient(90deg,#be185d,#f472b6);
      color:white;
      padding:.45rem .85rem;
      border-radius:999px;
      font-weight:700;
    }

    /* --- SUPPORT BOX FROM BTS PAGE --- */
    .support-box{
      background:white;
      border-radius:14px;
      padding:1.25rem;
      box-shadow:0 10px 25px rgba(0,0,0,0.06);
      border:1px solid rgba(235,224,232,0.6);
      max-width:900px;
      margin:1.5rem auto;
      text-align:center;
    }

    .support-box h2{
      color:var(--accent);
      font-weight:800;
      margin-bottom:.4rem;
    }

    .support-box p{
      color:#6b7280;
      margin-bottom:1rem;
    }

    textarea{
      width:100%;
      border:1px solid #e5d2dd;
      border-radius:10px;
      padding:.75rem;
      resize:none;
    }

    .support-btn{
      margin-top:.75rem;
      background:linear-gradient(90deg,#be185d,#f472b6);
      color:white;
      border-radius:999px;
      font-weight:700;
      padding:.6rem 1.25rem;
      display:inline-block;
    }

    /* --- MESSAGE CARDS --- */
    .msg-card{
      background:white;
      border-radius:12px;
      border:1px solid #f3d3e2;
      padding:1rem;
      margin:1rem auto;
      max-width:900px;
      box-shadow:0 4px 14px rgba(0,0,0,0.05);
    }

    .msg-name{
      font-weight:700;
      color:#111827;
      margin-bottom:.25rem;
    }

    .msg-text{
      color:#374151;
      margin-bottom:.5rem;
    }

    .msg-footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      color:#9ca3af;
      font-size:.85rem;
    }

    .heart{
      cursor:pointer;
      color:#be185d;
      font-weight:700;
    }

    @media(max-width:700px){
      .msg-card{ margin:1rem 1rem; }
      .support-box{ margin:1.25rem 1rem; }
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header>
    <div class="flex justify-between items-center px-6 py-4" style="max-width:1100px;margin:0 auto;">
      <div class="site-title" style="font-size:1.15rem;">THE FOOTBALLER’S SISTER</div>

      <div class="relative inline-block">
        <button id="navButton"
          class="inline-flex items-center gap-2 rounded-md border border-pink-200 shadow-sm px-4 py-2 bg-white text-sm font-medium text-rose-600 hover:bg-pink-50">
          <span id="navTitle">Support Wall</span>
          <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z"/>
          </svg>
        </button>

        <div id="dropdownMenu"
          class="hidden absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
          <a href="index.html" class="block px-4 py-2 text-sm hover:bg-pink-50">Home</a>
          <a href="bts.html" class="block px-4 py-2 text-sm hover:bg-pink-50">Behind the Game</a>
          <a href="leila.html" class="block px-4 py-2 text-sm hover:bg-pink-50">Meet Leila</a>
          <a href="questions.html" class="block px-4 py-2 text-sm hover:bg-pink-50">Q&A</a>
          <a href="support-wall.html" class="block px-4 py-2 text-sm hover:bg-pink-50 font-semibold text-rose-600">Support Wall</a>
          <a href="fixtures.html" class="block px-4 py-2 text-sm hover:bg-pink-50">Fixtures & Live Scores</a>
          <a href="giveaways.html" class="block px-4 py-2 text-sm hover:bg-pink-50">Giveaways</a>
        </div>
      </div>
    </div>
  </header>

  <!-- SPACING -->
  <div style="height:20px;"></div>

  <!-- SUPPORT BOX FROM BTS PAGE -->
  <section class="support-box">
    <h2>Share Your Support ❤️</h2>
    <p>Leave a message for the players or for Leila — your words mean everything.</p>

    <textarea id="msgInput" rows="3" placeholder="Write your message..."></textarea>
    <br>
    <button id="sendBtn" class="support-btn">Post Message</button>
  </section>

  <!-- MESSAGES LIST -->
  <section id="messagesList"></section>

  <!-- FOOTER -->
  <footer class="text-center py-6">
    <small class="footer-badge">© <span id="year"></span> The Footballer’s Sister</small>
  </footer>
  <script>document.getElementById("year").textContent = new Date().getFullYear();</script>

  <!-- FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp, onSnapshot, query, orderBy, updateDoc, doc } 
      from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBiIvIHLYEQc0UGDcg4Qq0-w2Sv8NHmc6w",
      authDomain: "football-site-c3aa9.firebaseapp.com",
      projectId: "football-site-c3aa9",
      storageBucket: "football-site-c3aa9.appspot.com",
      messagingSenderId: "65396604482",
      appId: "1:65396604482:web:0f31625a714aa8352337db"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const PATH = `artifacts/${firebaseConfig.appId}/public/data/supportMessages`;

    const msgInput = document.getElementById("msgInput");
    const sendBtn = document.getElementById("sendBtn");
    const list = document.getElementById("messagesList");

    // Load messages **immediately** (fix from earlier)
    function loadMessages(){
      const qRef = query(collection(db, PATH), orderBy("createdAt", "desc"));
      onSnapshot(qRef, snap=>{
        list.innerHTML = "";
        snap.forEach(docSnap=>{
          const m = docSnap.data();
          const card = document.createElement("div");
          card.className = "msg-card";
          card.innerHTML = `
            <div class="msg-name">${m.name || "Anonymous"}</div>
            <div class="msg-text">${m.message || ""}</div>
            <div class="msg-footer">
              <span>${m.createdAt?.seconds ? new Date(m.createdAt.seconds*1000).toLocaleString() : ""}</span>
              <span class="heart" data-id="${docSnap.id}">❤️ ${m.likes || 0}</span>
            </div>
          `;
          list.append(card);
        });

        // heart click
        document.querySelectorAll(".heart").forEach(h=>{
          h.onclick = async ()=>{
            const id = h.getAttribute("data-id");
            const ref = doc(db, PATH, id);
            await updateDoc(ref, { likes: (parseInt(h.textContent.replace("❤️","")) || 0) + 1 });
          };
        });
      });
    }

    loadMessages();

    sendBtn.onclick = async ()=>{
      const text = msgInput.value.trim();
      if(!text) return;

      await addDoc(collection(db, PATH), {
        name: "Supporter",
        message: text,
        likes: 0,
        createdAt: serverTimestamp()
      });

      msgInput.value = "";
    };


    // NAVIGATION DROPDOWN
    const navButton = document.getElementById("navButton");
    const dropdown = document.getElementById("dropdownMenu");

    navButton.onclick = ()=>{
      dropdown.classList.toggle("hidden");
    };

    document.addEventListener("click", e=>{
      if(!navButton.contains(e.target) && !dropdown.contains(e.target)){
        dropdown.classList.add("hidden");
      }
    });
  </script>

</body>
</html>
