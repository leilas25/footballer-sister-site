<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Q&A – The Footballer’s Sister</title>
  <meta name="description" content="The Q&A page by The Footballer’s Sister answers your questions about football life, content creation, family support, and behind-the-scenes experiences.">

  <meta property="og:title" content="The Footballer’s Sister" />
  <meta property="og:description" content="Behind-the-scenes matchdays, family journeys, and trusted essentials — from one football family to another." />
  <meta property="og:image" content="https://thefootballerssister.co.za/images/og-image.jpg" />
  <meta property="og:url" content="https://thefootballerssister.co.za" />
  <meta property="og:type" content="website" />

  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --bg: #fff7fb;
      --accent: #be185d;
      --muted: #6b7280;
      --card: #ffffff;
      --shadow: 0 10px 30px rgba(11,7,17,0.06);
    }
    body { background: #fff2f6; color: #111827; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
    header {
      background: linear-gradient(180deg, rgba(246,213,239,0.6), rgba(255,241,248,0.6));
      border-bottom: 1px solid rgba(235,200,215,0.6);
      backdrop-filter: blur(4px);
    }
    .site-title { color: var(--accent); font-weight: 800; letter-spacing: .02em; }
    main { padding-bottom: 6rem; }

    .qa-card {
      background: var(--card);
      border-radius: 14px;
      padding: 1.25rem 1.5rem;
      box-shadow: var(--shadow);
      border: 1px solid rgba(235,224,232,0.6);
    }
    .qa-grid { display:grid; grid-template-columns: 1fr; gap:1.25rem; }
    .qa-title { font-weight:800; font-size:1.05rem; color:#111827; }
    .qa-text { color:#374151; margin-top:.5rem; line-height:1.45; }
    .meta-row { display:flex; gap:.75rem; align-items:center; margin-top:.65rem; color:var(--muted); font-size:.9rem; }
    .chip-answered { background: linear-gradient(180deg,#ecfdf5,#dcfce7); color:#065f46; font-weight:700; padding:.4rem .6rem; border-radius:999px; font-size:.8rem; border:1px solid rgba(16,185,129,0.08); }
    .chip-unanswered { color:var(--muted); font-weight:600; font-size:.9rem; }

    .container { max-width:920px; margin:0 auto; padding:2.25rem 1.5rem; }
    .page-head { display:flex; align-items:center; gap:1rem; margin-bottom:1rem; }
    .page-h1 { font-size:2rem; font-weight:900; color:var(--accent); }
    .subtle { color:var(--muted); }

    .pager { display:flex; justify-content:center; margin-top:1.25rem; gap:.75rem; align-items:center; }
    .btn-pager { padding:.6rem 1rem; border-radius:999px; font-weight:700; background:white; border:1px solid rgba(0,0,0,0.06); cursor:pointer; box-shadow:0 6px 18px rgba(11,7,17,0.04); }
    .btn-primary { background: linear-gradient(90deg,#be185d,#f472b6); color:white; border:none; }

    .dropdown-open { opacity:1!important; transform:scale(1)!important; }

    @media (min-width:768px){
      .qa-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="sticky top-0 z-40">
    <div class="container" style="display:flex;justify-content:space-between;align-items:center;padding-top:1rem;padding-bottom:1rem;">
      <div style="display:flex;align-items:center;gap:1rem;">
        <div class="site-title" style="font-size:1.1rem;">THE FOOTBALLER’S SISTER</div>
      </div>

      <div class="relative inline-block text-left">
        <button id="navButton"
          class="inline-flex items-center justify-center rounded-md border border-pink-200 shadow-sm px-4 py-2 bg-white text-sm font-medium text-rose-600 hover:bg-pink-50 focus:outline-none">
          <span id="navTitle">Loading...</span>
          <svg class="-mr-1 ml-2 h-5 w-5 text-rose-600" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z"/>
          </svg>
        </button>

        <div id="dropdownMenu"
          class="hidden origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 transform transition-all duration-200 ease-out scale-95 opacity-0">
          <div class="py-1">
            <a href="/" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Home</a>
            <a href="/bts" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Behind the Game</a>
            <a href="/leila" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Meet Leila</a>
            <a href="/questions" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Q&A</a>
            <a href="/support-wall" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Support Wall</a>
            <a href="/fixtures" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Fixtures & Live Scores</a>
            <a href="/giveaways" class="nav-item block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50">Giveaways</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="container">

    <!-- Page title -->
    <div class="page-head">
      <h1 class="page-h1">Q&amp;A</h1>
    </div>

    <!-- ⭐ INSERTED FORM (working with Firebase) -->
    <section aria-label="Ask a question" style="margin-bottom:1.5rem;">
      <form id="qa-form" class="qa-card" style="display:grid;gap:.75rem;">
        <div style="display:flex;gap:.75rem;flex-wrap:wrap;">
          <input id="qa-name" placeholder="Your name (required)" 
            style="flex:1;padding:.6rem .8rem;border-radius:10px;border:1px solid rgba(0,0,0,0.06);" />

          <input id="qa-title" placeholder="Title (optional)" 
            style="flex:1;max-width:320px;padding:.6rem .8rem;border-radius:10px;border:1px solid rgba(0,0,0,0.06);" />
        </div>

        <textarea id="qa-question" placeholder="Write your question..."
          style="width:100%;padding:.8rem;border-radius:10px;border:1px solid rgba(0,0,0,0.06);min-height:100px;resize:vertical;"></textarea>

        <div style="display:flex;align-items:center;gap:.5rem;">
          <div id="qa-status" class="subtle">We'll read every question ❤️</div>
          <div style="margin-left:auto;">
            <button type="submit" class="btn-primary" 
              style="padding:.6rem .9rem;border-radius:999px;font-weight:700;">
              Send question
            </button>
          </div>
        </div>
      </form>
    </section>

    <!-- Existing questions list -->
    <section id="questionsSection" aria-label="Community questions">
      <div id="questionsList" class="qa-grid"></div>

      <div class="pager" id="pagerControls" style="display:none;">
        <button id="loadMoreBtn" class="btn-pager btn-primary">Load more</button>
        <button id="resetBtn" class="btn-pager" style="display:none;">Show fewer</button>
      </div>

      <p id="loading" class="subtle" style="margin-top:1.25rem;">Loading questions…</p>
      <p id="errorBox" class="subtle" style="margin-top:1rem; color:#b91c1c; display:none;"></p>
    </section>

  </main>

  <footer style="margin-top:3rem;">
    <div class="container" style="text-align:center;padding-top:1rem;padding-bottom:2rem;">
      <small style="color:rgba(255,255,255,0.95);background:linear-gradient(90deg,#be185d,#f472b6);
        padding:.4rem .8rem;border-radius:999px;">
        © <span id="year"></span> The Footballer’s Sister
      </small>
    </div>
  </footer>
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>

  <!-- Navbar dropdown script (unchanged) -->
  <script>
    (function () {
      const navButton = document.getElementById('navButton');
      const dropdownMenu = document.getElementById('dropdownMenu');
      const navItems = document.querySelectorAll('.nav-item');
      const navTitle = document.getElementById('navTitle');

      let currentPage = window.location.pathname.split('/').pop();
      if (!currentPage) currentPage = 'index.html';

      const titles = {
        "index.html": "Home",
        "bts.html": "Behind the Game",
        "leila.html": "Meet Leila",
        "questions.html": "Q&A",
        "support-wall.html": "Support Wall",
        "fixtures.html": "Fixtures & Live Scores"
      };
      navTitle.textContent = titles[currentPage] || "Menu";

      navItems.forEach(link => {
        if (link.getAttribute('href') === currentPage) {
          link.classList.add("font-semibold", "text-rose-600");
        }
      });

      navButton.onclick = (e) => {
        e.stopPropagation();
        const hidden = dropdownMenu.classList.contains('hidden');
        if (hidden) {
          dropdownMenu.classList.remove('hidden');
          setTimeout(()=>dropdownMenu.classList.add('dropdown-open'), 10);
        } else {
          dropdownMenu.classList.remove('dropdown-open');
          setTimeout(()=>dropdownMenu.classList.add('hidden'), 200);
        }
      };

      document.onclick = (e) => {
        if (!navButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
          dropdownMenu.classList.remove('dropdown-open');
          setTimeout(()=>dropdownMenu.classList.add('hidden'), 200);
        }
      };

      document.onkeydown = (e) => {
        if (e.key === 'Escape') {
          dropdownMenu.classList.remove('dropdown-open');
          setTimeout(()=>dropdownMenu.classList.add('hidden'), 200);
        }
      };
    })();
  </script>

  <!-- ★ Unified Firebase script (unchanged from merge) -->
  <script type="module">
    (async () => {
      try {
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js");
        const { getAuth, signInAnonymously, onAuthStateChanged } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");
        const { getFirestore, collection, addDoc, serverTimestamp, onSnapshot } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js");

        const firebaseConfig = {
          apiKey: "AIzaSyBiIvIHLYEQc0UGDcg4Qq0-w2Sv8NHmc6w",
          authDomain: "football-site-c3aa9.firebaseapp.com",
          projectId: "football-site-c3aa9",
          storageBucket: "football-site-c3aa9.appspot.com",
          messagingSenderId: "65396604482",
          appId: "1:65396604482:web:0f31625a714aa8357db"
        };
        const appId = '1:65396604482:web:0f31625a714aa8352337db';

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        const QUESTIONS_COLLECTION_PATH = `artifacts/${appId}/public/data/questions`;

        const qaForm = document.getElementById('qa-form');
        const qaStatus = document.getElementById('qa-status');
        const listEl = document.getElementById('questionsList');
        const loadingEl = document.getElementById('loading');
        const errorBox = document.getElementById('errorBox');
        const pagerControls = document.getElementById('pagerControls');
        const loadMoreBtn = document.getElementById('loadMoreBtn');
        const resetBtn = document.getElementById('resetBtn');

        const itemsPerPage = 6;
        let visibleCount = itemsPerPage;
        let allDocs = [];

        function escapeHtml(str) {
          return str ? String(str).replace(/[&<>"']/g, s => ({
            '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
          })[s]) : '';
        }

        function getQuestionText(d) {
          if (!d) return '';
          const keys = ['question','message','body','text','description','content'];
          for (const k of keys) if (d[k]) return d[k];
          for (const v of Object.values(d)) if (typeof v === 'string') return v;
          return '';
        }

        function renderVisible() {
          listEl.innerHTML = '';

          if (!allDocs.length) {
            listEl.innerHTML = '<div class="subtle">No questions yet.</div>';
            pagerControls.style.display = 'none';
            return;
          }

          const sorted = allDocs.slice().sort((a,b) => {
            const ta = a.data.createdAt?.seconds || 0;
            const tb = b.data.createdAt?.seconds || 0;
            return tb - ta;
          });

          const view = sorted.slice(0, visibleCount);

          view.forEach(it => {
            const d = it.data;
            const name = d.name || '';
            const title = d.title || 'Question';
            const qText = getQuestionText(d);
            const createdAt = d.createdAt?.seconds ? new Date(d.createdAt.seconds*1000).toLocaleString() : '';
            const answered = !!d.adminResponse;

            const card = document.createElement('article');
            card.className = 'qa-card';
            card.innerHTML = `
              <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;">
                <div style="flex:1;">
                  <div class="qa-title">${escapeHtml(title)}</div>
                  <div class="qa-text">${escapeHtml(qText)}</div>
                  <div class="meta-row">
                    ${name ? `Asked by ${escapeHtml(name)}` : ''}
                    ${createdAt ? `· ${escapeHtml(createdAt)}` : ''}
                  </div>
                </div>
                <div style="min-width:110px;text-align:right;">
                  ${answered ? '<div class="chip-answered">Answered</div>' : '<div class="chip-unanswered">Unanswered</div>'}
                </div>
              </div>
              ${answered ? `<div style="margin-top:1rem;padding:1rem;border-radius:10px;background:#f8fafc;">
                <strong>Reply:</strong> ${escapeHtml(d.adminResponse)}
              </div>` : ''}
            `;
            listEl.appendChild(card);
          });

          if (allDocs.length > itemsPerPage) {
            pagerControls.style.display = '';
            loadMoreBtn.style.display = visibleCount >= allDocs.length ? 'none' : '';
            resetBtn.style.display = visibleCount >= allDocs.length ? '' : 'none';
          } else {
            pagerControls.style.display = 'none';
          }
        }

        function updateDocs(newDocs) {
          allDocs = newDocs;
          if (visibleCount > allDocs.length) visibleCount = itemsPerPage;
          renderVisible();
        }

        let unsubscribe = null;
        function subscribeToQuestions() {
          if (unsubscribe) unsubscribe();

          loadingEl.style.display = '';
          errorBox.style.display = 'none';

          const collRef = collection(db, QUESTIONS_COLLECTION_PATH);
          unsubscribe = onSnapshot(
            collRef,
            snap => {
              loadingEl.style.display = 'none';
              updateDocs(snap.docs.map(d => ({ id: d.id, data: d.data() })));
            },
            err => {
              loadingEl.style.display = 'none';
              errorBox.style.display = '';
              errorBox.textContent = 'Error loading: ' + err.message;
            }
          );
        }

        loadMoreBtn.onclick = () => {
          visibleCount += itemsPerPage;
          renderVisible();
        };

        resetBtn.onclick = () => {
          visibleCount = itemsPerPage;
          renderVisible();
        };

        if (qaForm) {
          qaForm.addEventListener('submit', async e => {
            e.preventDefault();
            qaStatus.textContent = 'Sending...';

            const name = document.getElementById('qa-name').value.trim();
            const title = document.getElementById('qa-title').value.trim();
            const question = document.getElementById('qa-question').value.trim();

            if (!name || !question) {
              qaStatus.textContent = 'Please add name & question.';
              return;
            }

            try {
              await addDoc(collection(db, QUESTIONS_COLLECTION_PATH), {
                name,
                title,
                question,
                createdAt: serverTimestamp(),
                timestamp: serverTimestamp()
              });
              qaStatus.textContent = 'Question sent — thank you!';
              qaForm.reset();
              setTimeout(()=> qaStatus.textContent = '', 3000);
            } catch (err) {
              qaStatus.textContent = 'Failed to send.';
            }
          });
        }

        onAuthStateChanged(auth, user => {
          subscribeToQuestions();
          if (!user) signInAnonymously(auth);
        });

      } catch (err) {
        console.warn('Firebase failed:', err);
      }
    })();
  </script>

</body>
</html>
